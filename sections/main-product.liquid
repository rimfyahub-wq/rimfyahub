<section class="product-section" data-mouse-glow>
  <!-- Animated Background Gradients -->
  <div class="product-bg-gradient product-bg-current" data-gradient-layer="current"></div>
  <div class="product-bg-gradient product-bg-next" data-gradient-layer="next"></div>
  
  <!-- Mouse Follow Glow -->
  <div class="mouse-glow-overlay"></div>

  <div class="container">
    <div class="product-layout">
      
      <!-- Product Images Gallery -->
      <div class="product-gallery">
        <div class="product-gallery-glow"></div>
        
        {% if product.images.size > 0 %}
          <div class="product-main-image">
            <img 
              src="{{ product.featured_image | img_url: '800x' }}" 
              alt="{{ product.featured_image.alt | escape }}"
              class="product-image"
              id="mainProductImage"
            >
          </div>

          {% if product.images.size > 1 %}
            <div class="product-thumbnails">
              {% for image in product.images limit: 4 %}
                <div class="thumbnail-wrapper {% if forloop.first %}active{% endif %}" data-image-index="{{ forloop.index0 }}">
                  <div class="thumbnail-glow"></div>
                  <img 
                    src="{{ image | img_url: '150x' }}" 
                    alt="{{ image.alt | escape }}"
                    class="thumbnail-image"
                    onclick="changeMainImage('{{ image | img_url: '800x' }}', {{ forloop.index0 }})"
                  >
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% else %}
          <div class="product-no-image">
            <p>No image available</p>
          </div>
        {% endif %}
      </div>

      <!-- Product Info -->
      <div class="product-info">
        
        <!-- Product Title -->
        <h1 class="product-title">
          <span class="product-title-glow">{{ product.title }}</span>
        </h1>

        <!-- Product Price -->
        <div class="product-price-wrapper">
          {% if product.compare_at_price > product.price %}
            <span class="product-price-sale">{{ product.price | money }}</span>
            <span class="product-price-compare">{{ product.compare_at_price | money }}</span>
            <span class="product-sale-badge">SAVE {{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}%</span>
          {% else %}
            <span class="product-price">{{ product.price | money }}</span>
          {% endif %}
        </div>

        <!-- Product Description -->
        {% if product.description != blank %}
          <div class="product-description">
            {{ product.description }}
          </div>
        {% endif %}

        <!-- Product Form -->
        {% form 'product', product %}
          
          <!-- Variant Selector -->
          {% unless product.has_only_default_variant %}
            <div class="product-variants">
              {% for option in product.options_with_values %}
                <div class="variant-option">
                  <label class="variant-label">{{ option.name }}</label>
                  <div class="variant-buttons">
                    {% for value in option.values %}
                      <button 
                        type="button" 
                        class="variant-button {% if forloop.first %}active{% endif %}"
                        data-option-index="{{ option.position }}"
                        data-value="{{ value | escape }}"
                      >
                        {{ value }}
                      </button>
                    {% endfor %}
                  </div>
                </div>
              {% endfor %}
            </div>
          {% endunless %}

          <!-- Quantity Selector -->
          <div class="product-quantity">
            <label class="quantity-label">Quantity</label>
            <div class="quantity-selector">
              <button type="button" class="quantity-btn" onclick="decreaseQuantity()">âˆ’</button>
              <input 
                type="number" 
                name="quantity" 
                value="1" 
                min="1" 
                class="quantity-input"
                id="quantityInput"
              >
              <button type="button" class="quantity-btn" onclick="increaseQuantity()">+</button>
            </div>
          </div>

          <!-- Add to Cart Button -->
          <button 
            type="submit" 
            name="add"
            class="product-add-to-cart btn-primary glow-pulse"
            {% unless product.available %}disabled{% endunless %}
          >
            {% if product.available %}
              <span class="cart-icon">ðŸ›’</span>
              Add to Cart - {{ product.price | money }}
            {% else %}
              Sold Out
            {% endif %}
          </button>

          <!-- Buy Now Button -->
          {% if product.available %}
            <button type="button" class="product-buy-now btn-outline">
              Buy Now
            </button>
          {% endif %}

        {% endform %}

        <!-- Product Features -->
        <div class="product-features-list">
          <div class="feature-item">
            <span class="feature-icon">âœ“</span>
            <span class="feature-text">Free Shipping on Orders Over $50</span>
          </div>
          <div class="feature-item">
            <span class="feature-icon">âœ“</span>
            <span class="feature-text">30-Day Money-Back Guarantee</span>
          </div>
          <div class="feature-item">
            <span class="feature-icon">âœ“</span>
            <span class="feature-text">1-Year Warranty</span>
          </div>
          <div class="feature-item">
            <span class="feature-icon">âœ“</span>
            <span class="feature-text">24/7 Customer Support</span>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>

<style>
  .product-section {
    position: relative;
    min-height: 100vh;
    padding: 8rem 0 4rem;
    background: linear-gradient(180deg, #000000 0%, #0a0a0a 100%);
    overflow: hidden;
  }

  .product-bg-gradient {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    filter: blur(120px);
    pointer-events: none;
    transition: opacity 3000ms ease-in-out;
  }

  .product-bg-current {
    background: linear-gradient(135deg, hsl(193, 100%, 65%), hsl(280, 100%, 70%), hsl(330, 100%, 70%));
    opacity: 0.6;
  }

  .product-bg-next {
    background: linear-gradient(135deg, hsl(30, 100%, 65%), hsl(330, 100%, 70%), hsl(280, 100%, 70%));
    opacity: 0;
  }

  @keyframes productGradientMove {
    0%, 100% { transform: translate(0, 0) scale(1); }
    33% { transform: translate(10%, -10%) scale(1.1); }
    66% { transform: translate(-10%, 10%) scale(0.9); }
  }

  .product-layout {
    display: grid;
    grid-template-columns: 1fr;
    gap: 3rem;
    position: relative;
    z-index: 1;
  }

  @media (min-width: 1024px) {
    .product-layout {
      grid-template-columns: 1fr 1fr;
      gap: 5rem;
    }
  }

  /* Product Gallery */
  .product-gallery {
    position: relative;
  }

    .product-image-glow {
    position: absolute;
    inset: -2rem;
    background: linear-gradient(135deg, rgba(147, 51, 234, 0.5), rgba(59, 130, 246, 0.5));
    filter: blur(60px);
    opacity: 0.8;
    transition: opacity 0.5s;
    border-radius: 1rem;
    z-index: 0;
  }

  .product-gallery:hover .product-gallery-glow {
    opacity: 1;
  }

  .product-main-image {
    position: relative;
    border-radius: 1rem;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    aspect-ratio: 1;
  }

  .product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .product-main-image:hover .product-image {
    transform: scale(1.05);
  }

  .product-no-image {
    display: flex;
    align-items: center;
    justify-content: center;
    aspect-ratio: 1;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .product-thumbnails {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    margin-top: 1rem;
  }

  .thumbnail-wrapper {
    position: relative;
    aspect-ratio: 1;
    border-radius: 0.5rem;
    overflow: hidden;
    cursor: pointer;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid transparent;
    transition: all 0.3s;
  }

  .thumbnail-wrapper.active,
  .thumbnail-wrapper:hover {
    border-color: hsl(193, 100%, 65%);
  }

  .thumbnail-glow {
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(0, 229, 255, 0.3), rgba(191, 0, 255, 0.3));
    opacity: 0;
    transition: opacity 0.3s;
  }

  .thumbnail-wrapper:hover .thumbnail-glow,
  .thumbnail-wrapper.active .thumbnail-glow {
    opacity: 0.5;
  }

  .thumbnail-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: relative;
    z-index: 1;
  }

  /* Product Info */
  .product-info {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .product-title {
    font-size: 2rem;
    font-weight: 700;
    margin: 0;
    line-height: 1.2;
  }

  @media (min-width: 640px) {
    .product-title {
      font-size: 2.5rem;
    }
  }

  @media (min-width: 1024px) {
    .product-title {
      font-size: 3rem;
    }
  }

  .product-title-glow {
    background: linear-gradient(135deg, #00E5FF, #BF00FF, #FF00BF);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .product-price-wrapper {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .product-price,
  .product-price-sale {
    font-size: 2rem;
    font-weight: 700;
    color: hsl(193, 100%, 65%);
  }

  .product-price-compare {
    font-size: 1.5rem;
    color: rgba(255, 255, 255, 0.5);
    text-decoration: line-through;
  }

  .product-sale-badge {
    padding: 0.25rem 0.75rem;
    background: linear-gradient(135deg, #FF00BF, #BF00FF);
    border-radius: 0.25rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: white;
  }

  .product-description {
    font-size: 1.125rem;
    line-height: 1.75;
    color: rgba(255, 255, 255, 0.8);
  }

  /* Variant Selector */
  .product-variants {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .variant-option {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .variant-label {
    font-size: 1rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
  }

  .variant-buttons {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
  }

  .variant-button {
    padding: 0.75rem 1.5rem;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 0.5rem;
    color: white;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s;
  }

  .variant-button:hover,
  .variant-button.active {
    border-color: hsl(193, 100%, 65%);
    background: rgba(0, 229, 255, 0.1);
    box-shadow: 0 0 20px rgba(0, 229, 255, 0.3);
  }

  /* Quantity Selector */
  .product-quantity {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .quantity-label {
    font-size: 1rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
  }

  .quantity-selector {
    display: flex;
    align-items: center;
    gap: 0;
    width: fit-content;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 0.5rem;
    border: 2px solid rgba(255, 255, 255, 0.2);
    overflow: hidden;
  }

  .quantity-btn {
    width: 3rem;
    height: 3rem;
    background: transparent;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .quantity-btn:hover {
    background: rgba(0, 229, 255, 0.2);
  }

  .quantity-input {
    width: 4rem;
    height: 3rem;
    background: transparent;
    border: none;
    border-left: 1px solid rgba(255, 255, 255, 0.2);
    border-right: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    font-size: 1.125rem;
    font-weight: 600;
    text-align: center;
    -moz-appearance: textfield;
  }

  .quantity-input::-webkit-outer-spin-button,
  .quantity-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Buttons */
  .product-add-to-cart,
  .product-buy-now {
    width: 100%;
    padding: 1.25rem 2rem;
    font-size: 1.125rem;
    font-weight: 600;
    border-radius: 0.5rem;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
  }

  .product-add-to-cart {
    background: linear-gradient(135deg, hsl(193, 100%, 65%), hsl(280, 100%, 70%), hsl(330, 100%, 70%));
    color: white;
  }

  .product-add-to-cart:hover:not(:disabled) {
    box-shadow: 0 0 40px rgba(0, 229, 255, 0.6);
    transform: translateY(-2px);
  }

  .product-add-to-cart:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .product-buy-now {
    background: transparent;
    border: 2px solid rgba(0, 229, 255, 0.5);
    color: white;
  }

  .product-buy-now:hover {
    border-color: hsl(193, 100%, 65%);
    box-shadow: 0 0 30px rgba(0, 229, 255, 0.4);
    background: rgba(0, 229, 255, 0.1);
  }

  .cart-icon {
    font-size: 1.5rem;
  }

  /* Product Features List */
  .product-features-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 0.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .feature-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: rgba(255, 255, 255, 0.8);
  }

  .feature-icon {
    width: 1.5rem;
    height: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #00E5FF, #BF00FF);
    border-radius: 50%;
    font-size: 0.875rem;
    flex-shrink: 0;
  }

  .feature-text {
    font-size: 0.9375rem;
  }
</style>

<script>
  // Change main product image
  function changeMainImage(imageUrl, index) {
    const mainImage = document.getElementById('mainProductImage');
    if (mainImage) {
      mainImage.src = imageUrl;
    }
    
    // Update active thumbnail
    document.querySelectorAll('.thumbnail-wrapper').forEach((thumb, i) => {
      thumb.classList.toggle('active', i === index);
    });
  }

  // Quantity controls
  function increaseQuantity() {
    const input = document.getElementById('quantityInput');
    if (input) {
      input.value = parseInt(input.value) + 1;
    }
  }

  function decreaseQuantity() {
    const input = document.getElementById('quantityInput');
    if (input && parseInt(input.value) > 1) {
      input.value = parseInt(input.value) - 1;
    }
  }

  // Variant selection
  document.addEventListener('DOMContentLoaded', function() {
    const variantButtons = document.querySelectorAll('.variant-button');
    
    variantButtons.forEach(button => {
      button.addEventListener('click', function() {
        // Remove active class from siblings
        const siblings = this.parentElement.querySelectorAll('.variant-button');
        siblings.forEach(btn => btn.classList.remove('active'));
        
        // Add active class to clicked button
        this.classList.add('active');
      });
    });

    // Buy Now functionality
    const buyNowBtn = document.querySelector('.product-buy-now');
    if (buyNowBtn) {
      buyNowBtn.addEventListener('click', function() {
        // Submit form and redirect to checkout
        const form = document.querySelector('form[action*="/cart/add"]');
        if (form) {
          // Create a hidden input for checkout redirect
          const checkoutInput = document.createElement('input');
          checkoutInput.type = 'hidden';
          checkoutInput.name = 'return_to';
          checkoutInput.value = '/checkout';
          form.appendChild(checkoutInput);
          
          form.submit();
        }
      });
    }
  });

  // Gradient Animation for Product Page
  (function() {
    const gradients = [
      'linear-gradient(135deg, hsl(193, 100%, 65%), hsl(280, 100%, 70%), hsl(330, 100%, 70%))',
      'linear-gradient(135deg, hsl(30, 100%, 65%), hsl(330, 100%, 70%), hsl(280, 100%, 70%))',
      'linear-gradient(135deg, hsl(280, 100%, 70%), hsl(193, 100%, 65%), hsl(30, 100%, 65%))',
      'linear-gradient(135deg, hsl(330, 100%, 70%), hsl(30, 100%, 65%), hsl(193, 100%, 65%))'
    ];
    
    let currentIndex = 0;
    const currentLayer = document.querySelector('.product-bg-current');
    const nextLayer = document.querySelector('.product-bg-next');
    
    if (currentLayer && nextLayer) {
      function changeGradient() {
        const nextIndex = (currentIndex + 1) % gradients.length;
        
        nextLayer.style.background = gradients[nextIndex];
        nextLayer.style.opacity = '0.6';
        currentLayer.style.opacity = '0';
        
        setTimeout(() => {
          currentLayer.style.background = gradients[nextIndex];
          currentLayer.style.opacity = '0.6';
          nextLayer.style.opacity = '0';
          currentIndex = nextIndex;
        }, 3000);
      }
      
      setInterval(changeGradient, 6000);
    }
  })();
</script>

{% schema %}
{
  "name": "Product",
  "settings": []
}
{% endschema %}
